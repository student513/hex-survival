local Players = game:GetService("Players")
local LeaderManager = {}

-- 1ë“± í”Œë ˆì´ì–´ ë¨¸ë¦¬ ìœ„ì— ì™•ê´€ì„ ì”Œìš°ëŠ” ê¸°ëŠ¥
function LeaderManager.updateCrown(playerStats)
	local leaderPlayer = nil
	local maxWins = 0

	-- 1. í˜„ì¬ ì ‘ì†ì ì¤‘ ê°€ì¥ ìŠ¹ìˆ˜ê°€ ë§ì€ í”Œë ˆì´ì–´ í™•ì¸
	for name, stats in pairs(playerStats) do
		if stats.wins > maxWins then
			maxWins = stats.wins
			leaderPlayer = Players:FindFirstChild(name)
		end
	end

	-- 2. ëª¨ë“  í”Œë ˆì´ì–´ ìºë¦­í„°ì—ì„œ ê¸°ì¡´ ì™•ê´€ ì œê±°
	for _, player in ipairs(Players:GetPlayers()) do
		local char = player.Character
		if char then
			local existingCrown = char:FindFirstChild("LeaderCrown")
			if existingCrown then existingCrown:Destroy() end
		end
	end

	-- 3. 1ë“±ì´ ì¡´ì¬í•˜ê³  ì ìˆ˜ê°€ 1ì  ì´ìƒì´ë©´ ì™•ê´€ ìƒì„±
	if leaderPlayer and leaderPlayer.Character and maxWins > 0 then
		local head = leaderPlayer.Character:FindFirstChild("Head")
		if head then
			local billboard = Instance.new("BillboardGui")
			billboard.Name = "LeaderCrown"
			billboard.Size = UDim2.new(2, 0, 2, 0)
			billboard.StudsOffset = Vector3.new(0, 3, 0)
			billboard.Adornee = head
			billboard.AlwaysOnTop = true -- ë‹¤ë¥¸ ì¸µì— ìˆì–´ë„ í‘œì ì„ì„ ì•Œ ìˆ˜ ìˆê²Œ í•¨
			billboard.Parent = leaderPlayer.Character

			local textLabel = Instance.new("TextLabel")
			textLabel.BackgroundTransparency = 1
			textLabel.Size = UDim2.new(1, 0, 1, 0)
			textLabel.Text = "ğŸ‘‘"
			textLabel.TextScaled = true
			textLabel.Parent = billboard
		end
	end
end

return LeaderManager